# Открываем iptables

**1) Установите iptables**

```sh
apt-get install iptables
```

**2) Проверьте осталась ли возможность подключения по ssh к вашему серверу.**

Такая возможность осталась, так как iptables изначально отключена и не настроен конфиг.

![image](https://github.com/user-attachments/assets/750b7d3c-d038-4d70-8c02-496e8f5575ab)

**3) Почему может пропасть такая возможность?**

Такая возможность может пропасть, если заблокирован порт 22 (или любой другой, указанный в конфиге ssh).

**4) Откройте нужный порт на сервере чтобы восстановить подключение**

```sh
iptables -A INPUT -p tcp --dport 22 -j ACCEPT
```

Проверяем:

![image](https://github.com/user-attachments/assets/f1a0913b-5c99-49c4-931d-e5f5a87980ad)


**5) Это будет udp или tcp порт?**

ssh использует TCP, так как это протокол с установленным соединением.

# Сохраняем

**6) Сохраняются ли записанные вами правила после перезагрузки?**

iptables не сохраняет правила автоматически после перезагрузки, поэтому их необходимо сохранять.

**7) Как их сохранить?**

```sh
sudo iptables-save -f /etc/sysconfig/iptables
```

Перезагружаем систему и проверяем наличие правила:

![image](https://github.com/user-attachments/assets/2eea5fe6-0454-4f66-b30f-f503fe871586)


При работе с firewall не рекомендую отключаться от текущей сессии ssh. Лучше подключаться из другой консольки.
